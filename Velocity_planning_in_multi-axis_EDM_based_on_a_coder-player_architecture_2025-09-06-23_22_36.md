

<!-- Meanless: Journal of Manufacturing Systems 59 (2021) 299-309 Contents lists available at ScienceDirect Journal of Manufacturing Systems ELSEVIER journal homepage: www.elsevier.com/locate/jmansys updates-->

Technical Paper

# Velocity planning in multi-axis EDM based on a coder-player architecture

Xue-Cheng Xi \( {}^{\mathrm{a}, * } \) ,Hong-Da Liu \( {}^{\mathrm{b}} \) ,Mo Chen \( {}^{\mathrm{a},\mathrm{c}} \) ,Wan-Sheng Zhao \( {}^{\mathrm{a}} \)

\( {}^{a} \) Shenzhen Research Institute,State Key Laboratory of Mechanical System and Vibration,School of Mechanical Engineering,Shanghai Jiao Tong University,Shanghai 200240, China

\( {}^{b} \) State Key Laboratory of Heavy Duty AC Drive Electric Locomotive Systems Integration,Zhuzhou,Hunan 412001,China

\( {}^{c} \) Department of Production Engineering,KTH Royal Institute of Technology,Stockholm 10044,Sweden

## ARTICLEINFO

Keywords:

Velocity planning

Multi-axis EDM

Coder-player architecture

Shrouded blisk

## A B S T R A C T

With a higher requirement on machining accuracy in electrical discharging machining (EDM), there is a drastically increased number of multi-axis line segments for machining complex workpieces. High speed jumping is needed for a conducive discharge gap status. The increased number of line segments, however, makes the implementation of high-speed jumping difficult. To alleviate the online computational burden for velocity planning, this paper proposes a multi-axis velocity planning based on a coder-player architecture. Under this architecture, a multi-axis feeding trajectory is represented by a series of double non-uniform rational B-spline (NURBS) curves, which are then interpolated by the unit arc length increment interpolation (UALII) method. Based on the interpolation points with a resolution of a basic length unit (BLU), a velocity limit curve is generated by considering simultaneously the constraints on chord error, acceleration and jerk. The velocity planning is implemented under a coder-player architecture. As a trajectory represented by a double-NURBS curve has \( {C}^{2} \) continuity,velocity losses can be avoided at junctions between line segments,thus smoothing of line segments at junctions is unnecessary in jumping. Machining tests showed that by the use of the velocity planning based on double-NURBS curves, the machining time for one channel of a shrouded blisk can be decreased by 29.38%.

## 1. Introduction

To machine complex workpieces such as shrouded blisks, multi-axis electrical discharging machining (EDM) machines need to carry out coordinated movements involving both linear and rotary axes [1,2]. With involvement of rotary axes, feeding trajectories are no longer linear or circular ones, instead they are more complicated trajectories expressed in parametric curves. However, most multi-axis EDM machines can only interpolate linear (G01) or circular (G02/G03) trajectories. In EDM machines with more than three axes, a trajectory can be described as a generalized line as shown in Fig. 1. Coordination among different axes can be achieved by feeding each axis proportionally, regardless whether it is a linear axis or a rotary axis. Though generalized lines are normally used in multi-axis EDM, axes of motion need to experience frequent accelerations/decelerations at junctions between line segments. Frequent accelerations/decelerations can cause speed fluctuations, adversely affecting machining efficiency [3,4]. Low machining efficiency is a problem of multi-axis EDM for shrouded blisks. Therefore, velocity planning of multi-axis EDM is necessary for improving machining efficiency.

Few papers have been devoted to movements in multi-axis EDM, and related papers on multi-axis machining are mostly for milling [5,6]. To achieve a smooth trajectory, constraints on velocity, acceleration and jerk must be considered in the velocity planning for multi-axis machining \( \left\lbrack  {7,8}\right\rbrack \) . A maximum jerk value is determined by axial dynamics [9]. Jerks need to be minimized for multi-axis flank milling [10]. Depending on various applications, an optimal tool path can be searched for minimizing geometrical errors on finished surfaces [11], or for a locally optimal tool posture [12]. A path planning algorithm under velocity constraints was proposed with an application to additive manufacturing [13].

Trajectories for multi-axis milling can be represented by two nonuniform rational B-spline (NURBS) curves in the workpiece frame [14], which can be represented by two points on a tool: one is the tip of the tool, and the other is a point on the rotary axis of the tool. As the distance between the two points is constant, the position and orientation of the tool can be represented by the two points of the two NURBS curves in the workpiece frame, respectively. Unlike traditional milling in which most of the tools are of cylinder type, shapes of electrodes in EDM are various to a large extent. It is difficult to choose two points on an electrode to represent a feeding trajectory in a unified manner. A multi-axis EDM feeding trajectory is usually represented by a generalized line in the machine frame.

---

<!-- Footnote -->

* Corresponding author.

E-mail address: xixuecheng@gmail.com (X.-C. Xi).

<!-- Footnote -->

---

<!-- Meanless: https://doi.org/10.1016/j.jmsy.2021.01.010 Received 12 May 2020; Received in revised form 20 January 2021; Accepted 20 January 2021 Available online 16 March 2021 0278-6125/(C) 2021 The Society of Manufacturing Engineers. Published by Elsevier Ltd. All rights reserved.-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

<!-- Media -->

<!-- figureText: \( {P}_{1} \) G01 X-2.137 Y-32.623 Z0.000 Axial Displacements \( X \) \( Y \) Z \( Y \) \( A \) \( B \) Z A0.000 B-0.250 C-21.550 \( {P}_{2} \) G01 X-3.137 Y-34.623 Z0.000 A0.000 B-0.450 C-28.550 ...... -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_1.jpg?x=337&y=151&w=1073&h=527&r=0"/>

Fig. 1. A generalized line representing a six-dimensional feeding trajectory.

<!-- figureText: A C B A \( {u}_{m + 2} \) \( {u}_{o} \) Z Y X B -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_1.jpg?x=332&y=775&w=1081&h=697&r=0"/>

Fig. 2. Description of an electrode feeding trajectory.

<!-- Media -->

A feeding trajectory represented by a parametric curve is obtained by trajectory searching in a computer-aided manufacturing (CAM) system \( \left\lbrack  {{15},{16}}\right\rbrack \) . A generalized line in terms of G01 codes is then generated in post-processing from the parametric curve with a constraint on chord errors. With a higher requirement on machining accuracy, the number of G-code lines increases drastically. A large number of G-code lines in EDM, however, can make high speed jumping impossible. Therefore, there exists a strong need for an interpolation method and a corresponding velocity planning method for parametric curves in multi-axis EDM.

Chen et al. [17] proposed a velocity planning using a NURBS curve in the workpiece frame. Chen et al. [18] represented a six-dimensional trajectory by four NURBS curves, with one curve describing the three linear axes,i.e.,the \( X - ,Y - ,Z \) -axes,and the other three curves representing the three rotary axes,i.e.,the \( A - ,B - ,C \) -axes,respectively. In order to use the interpolation results by the unit arc length increment interpolation (UALII) in computer numerical control (CNC), Zhao et al. [19] proposed a coder-player CNC architecture. \( {}^{1} \) By using the coder-player architecture, interpolation is carried out offline while velocity planning is conducted online. Chen et al. [18] proposed the unit arc length increment scanning method (UALISM) to provide a velocity limit curve which is necessary in velocity planning for UALII interpolation points. While constraints on chord error and axial acceleration are considered by UALISM, constraints on normal acceleration and jerk are not considered.

This paper proposes a multi-axis velocity planning based on a coder-player architecture. Under this architecture, a multi-axis feeding trajectory is represented by a series of double-NURBS curves, which are then interpolated by the UALII method. Based on the interpolation points with a resolution of a basic length unit (BLU), a velocity limit curve is generated by considering simultaneously the constraints on chord error, acceleration and jerk.

---

<!-- Footnote -->

\( {}^{1} \) Coder is used instead of digitizer as coder incorporates both the digitization process and the coding protocol.

<!-- Footnote -->

---

<!-- Meanless: 300-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

<!-- Media -->

<!-- figureText: Z G01 X-2.137 Y-32.623 Z0.000 A0.000 B-0.250 C-21.550 G01 X-3.137 Y-34.623 Z0.000 A0.000 B-0.450 C-28.550 ...... ABC \( {\mathbf{C}}^{r}\left( u\right)  = \{ \alpha \left( u\right) ,\beta \left( u\right) ,\gamma \left( u\right) \} \) C BLU of the X-, Y-, Z-axis motion B ABC’s curve \( {P}_{2} \) XYZ \( {\mathbf{C}}^{l}\left( u\right)  = \{ x\left( u\right) ,y\left( u\right) ,z\left( u\right) \} \) 乙 BLU of the X-, Y-, Z-axis motion \( P \) XYZ's curve -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_2.jpg?x=334&y=147&w=1078&h=703&r=0"/>

Fig. 3. Dual NURBS curves under a machine frame.

<!-- Media -->

## 2. Representation and interpolation of trajectories in multi-axis EDM

### 2.1. Double NURBS curves

For machining a shrouded blisk, a continuous trajectory for multi-axis EDM is usually discretized into small line segments. Each line segment is processed individually to obtain discrete points on the trajectory, which contains coordinates for both positions and angles in a six dimensional space. Though it is usually difficult to have a six-dimensional NURBS curve, it is convenient to have a position curve and an angular curve to describe a feeding trajectory for multi-axis EDM.

As shown in Fig. 2, position coordinates and angle coordinates lie in the position space XYZ and the angle space ABC, respectively. The feeding space can be split into the position and angle spaces as

\[\left\{  \begin{array}{l} {C}^{l}\left( u\right)  = \frac{\mathop{\sum }\limits_{{i = 0}}^{n}{w}_{i}^{l}{Q}_{i}^{l}{N}_{i,3}\left( u\right) }{\mathop{\sum }\limits_{{i = 0}}^{n}{Q}_{i}^{l}{N}_{i,3}\left( u\right) } = \{ x\left( u\right) ,y\left( u\right) ,z\left( u\right) \} \\  {C}^{r}\left( u\right)  = \frac{\mathop{\sum }\limits_{{i = 0}}^{n}{w}_{i}^{r}{Q}_{i}^{r}{N}_{i,3}\left( u\right) }{\mathop{\sum }\limits_{{i = 0}}^{n}{Q}_{i}^{r}{N}_{i,3}\left( u\right) } = \{ \alpha \left( u\right) ,\beta \left( u\right) ,\gamma \left( u\right) \}  \end{array}\right.  \tag{1}\]

where \( {C}^{l}\left( u\right) \) is the position curve, \( {C}^{r}\left( u\right) \) is the angle curve, \( {w}_{i}^{l} \) and \( {w}_{i}^{r} \) are the weight factors, \( {Q}_{i}^{l} \) and \( {Q}_{i}^{r} \) are the control points for the two curves. Interpolated points for positions and angles must be kept synchronized. For this reason,the parameters, \( u \) ,for the two curves are the same. As the position and angle curves use the same knot vectors, the base functions are all \( {N}_{i,3}\left( u\right) \) . As shown in Fig. 3,an original feeding trajectory in terms of a generalized line can now be expressed as two NURBS curves.

### 2.2. Unit arc length increment interpolation for double-NURBS curves

Zhao et al. [20] proposed the unit arc length increment interpolation (UALII) for different smooth curves, especially NURBS curves. The basic idea for UALII is that a curve is interpolated in terms of a basic length unit (BLU), which is usually determined by the resolution of a positional feedback scale. Chen et al. [18] extended UALII to parallel curves in which arc length is used to calculate the parameter \( {u}_{k} \) to achieve coordination among different axes. \( {u}_{k} \) can then be used to calculate interpolation points. This paper proposes an interpolation method for two parallel curves, with one acting as a primary curve, and the other acting as a following curve. The parameter \( {u}_{k} \) is generated from the primary curve,and \( {u}_{k} \) is then substituted into the following curve to calculate the arc length to obtain interpolation points.

Double-NURBS curves are used to describe a feeding trajectory. However, an actual feeding trajectory usually consists of a number of double-NURBS curves which are concatenated to construct a feeding trajectory. In this paper, \( {C}_{I}^{l}\left( u\right) \) and \( {C}_{I}^{r}\left( u\right) \) are used to denote the \( I \) th position and angle curves,respectively,and \( {L}_{I}^{l} \) and \( {L}_{I}^{r} \) are the arc lengths of the position and angle curves, respectively. In order to achieve a synchronized interpolation, the maximum arc length in the Ith segment can be calculated as

\[{L}_{I}^{\max } = \max \left\{  {{L}_{I}^{l},{L}_{I}^{r}}\right\}   \tag{2}\]

Here in the \( I \) th segment,the curve with the maximum arc length is denoted as the primary curve, while the other is denoted as the following curve. By using the UALII, the maximum arc length increment for the primary curve in one interpolation step is 1 BLU, while the interpolation increment for the following curve is less than or equal to 1 BLU. The arc length increment for each parametric curve can be written as

\[\Delta {s}_{I}^{l} = \frac{{L}_{I}^{l}}{{L}_{I}^{\max }} \tag{3}\]

\[\Delta {s}_{I}^{r} = \frac{{L}_{I}^{r}}{{L}_{I}^{\max }} \tag{4}\]

In the calculation of UALII, the most important step is to calculate the parameter \( {u}_{k} \) based on the arc length increment \( {\Delta s} \) . The computed \( {u}_{k} \) can be substituted into the corresponding \( {C}_{I}^{l}\left( u\right) \) and \( {C}_{I}^{r}\left( u\right) \) to compute the interpolation points at each interpolation step.

As mentioned before, to ensure a strict synchronization for the two curves in each segment,the parameter \( {u}_{k} \) is firstly computed for the primary curve,and \( {u}_{k} \) is then used for the following curve. Among the two curves within each segment, only the primary curve is used for calculating the parameter \( {u}_{k} \) . As the increments of arc length are in terms of BLU, the computational load can be heavy. However, as the parameter \( {u}_{k} \) is required only for once,the computation for \( {u}_{k} \) can be carried out offline. The computation of the parameter \( {u}_{k} \) based on the arc length increment \( \Delta {s}_{k} \) is the core task of the interpolation method. The most widely-used method is to use the Taylor series expansion to express the value of \( {u}_{k} \) in terms of \( {u}_{k - 1} \) in a recursive approach [21]. For most cases, the expansion to the second order is enough to have an acceptable accuracy. By expanding to the second order, \( {u}_{k} \) can be expressed as

<!-- Meanless: 301-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

\[{u}_{k} = {u}_{k - 1} + {\left. \Delta s \cdot  \frac{\mathrm{{du}}}{\mathrm{{ds}}}\right| }_{u = {u}_{k - 1}} + {\left. \frac{1}{2}\Delta {s}^{2} \cdot  \frac{{d}^{2}u}{{\mathrm{\;{ds}}}^{2}}\right| }_{u = {u}_{k - 1}} + O\left( {\Delta {s}^{3}}\right)  \tag{5}\]

<!-- Media -->

<!-- figureText: Command + direction Scanning points (a) (b) Velocity curve (c) trajectory Velocity limit curve Velocity limit at scanning point \( v \) -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_3.jpg?x=202&y=150&w=556&h=1375&r=0"/>

Fig. 4. Flow chart of velocity planning for dual-NURBS curves.

<!-- Media -->

When the first order derivative \( \begin{Vmatrix}{{C}^{\prime }\left( u\right) }\end{Vmatrix} \neq  0 \) ,

\[\frac{\mathrm{{du}}}{\mathrm{{ds}}} = \frac{1}{\begin{Vmatrix}{C}^{\prime }\left( u\right) \end{Vmatrix}} \tag{6}\]

From this, we can get

\[\frac{{d}^{2}u}{{\mathrm{\;{ds}}}^{2}} = \frac{d}{\mathrm{{ds}}}\left( \frac{\mathrm{{du}}}{\mathrm{{ds}}}\right)  = \frac{d}{\mathrm{{du}}}\left( \frac{\mathrm{{du}}}{\mathrm{{ds}}}\right)  \cdot  \frac{\mathrm{{du}}}{\mathrm{{ds}}} =  - \frac{{C}^{\prime }\left( u\right) {C}^{\prime \prime }\left( u\right) }{{\begin{Vmatrix}{C}^{\prime }\left( u\right) \end{Vmatrix}}^{4}} \tag{7}\]

Substituting Eqs. (6) and (7) into Eq. (5), \( {u}_{k} \) can be written as

\[{u}_{k} = {u}_{k - 1} + {\Delta s} \cdot  \frac{1}{\begin{Vmatrix}{C}^{\prime }\left( {u}_{k - 1}\right) \end{Vmatrix}} + \frac{1}{2}\Delta {s}^{2} \cdot  \frac{{C}^{\prime }\left( {u}_{k - 1}\right) {C}^{\prime \prime }\left( {u}_{k - 1}\right) }{{\begin{Vmatrix}{C}^{\prime }\left( {u}_{k - 1}\right) \end{Vmatrix}}^{4}} + O\left( {\Delta {s}^{3}}\right)  \tag{8}\]

The parameter \( {u}_{k} \) must be obtained from the arc length \( s \) . It can be noticed from Eq. (8) that when \( \begin{Vmatrix}{{C}^{\prime }\left( {u}_{k - 1}\right) }\end{Vmatrix} \) approaches \( 0,{u}_{k} \) will become divergent. This divergence can cause cumulative errors in subsequent computations, seriously affecting the interpolation accuracy. A nice thing about the coder-player architecture is that the UALII interpolation can be carried out offline, it is therefore possible to use more accurate algorithms to calculate the parameter \( {u}_{k} \) of the curve. Several algorithms have been proposed to address this problem, such as, the augmented Taylor series expansion method [22], the polynomial interpolation method [23-25] and the predictor-corrector method [26-28]. Whatever algorithm is used,the increment \( {\Delta s} \) in the arc length \( {s}_{k} \) can be used to compute the increment \( {\Delta u} \) in the curve parameter \( {u}_{k} \) . With \( \Delta {u}_{k} \) ,the interpolation for a double-NURBS curve can be carried out. With its value obtained, \( {u}_{k} \) is substituted into Eq. (1) to calculate the current interpolation point as

\[C\left( {u}_{k}\right)  = {\left( {C}^{l}\left( {u}_{k}\right) ,{C}^{r}\left( {u}_{k}\right) \right) }^{T} \tag{9}\]

\[ = {\left( x\left( {u}_{k}\right) ,y\left( {u}_{k}\right) ,z\left( {u}_{k}\right) ,\alpha \left( {u}_{k}\right) ,\beta \left( {u}_{k}\right) ,\gamma \left( {u}_{k}\right) \right) }^{T}\]

The coordinates calculated from Eq. (9) are of floating values, while the unit used in UALII is BLU. Therefore to use the calculated results in UALII, it is necessary to round off the results as

\[\left\lbrack  {C\left( {u}_{k}\right) }\right\rbrack   = {\left( \left\lbrack  x\left( {u}_{k}\right) \right\rbrack  ,\left\lbrack  y\left( {u}_{k}\right) \right\rbrack  ,\left\lbrack  z\left( {u}_{k}\right) \right\rbrack  ,\left\lbrack  \alpha \left( {u}_{k}\right) \right\rbrack  ,\left\lbrack  \beta \left( {u}_{k}\right) \right\rbrack  ,\left\lbrack  \gamma \left( {u}_{k}\right) \right\rbrack  \right) }^{T} \tag{10}\]

where \( \left\lbrack  \cdot \right\rbrack \) is the function which rounds the value to the resolution of 1 BLU. The increment between two neighboring points is

\[\Delta {P}_{k} = \left\lbrack  {C\left( {u}_{k}\right)  - C\left( {u}_{k - 1}\right) }\right\rbrack   \tag{11}\]

\[ = {\left\lbrack  \Delta x\left( {u}_{k}\right) ,\Delta y\left( {u}_{k}\right) ,\Delta z\left( {u}_{k}\right) ,\Delta \alpha \left( {u}_{k}\right) ,\Delta \beta \left( {u}_{k}\right) ,\Delta \gamma \left( {u}_{k}\right) \right\rbrack  }^{T}\]

## 3. Velocity limit curve for a double-NURBS curve

To have a general picture of the proposed velocity planning algorithm, a flow chart is given in Fig. 4. The velocity planning basically consists of three steps: part (a) of Fig. 4 illustrates the scanning of a command trajectory, part (b) shows the generation of a velocity limit curve at a series of scanning points by considering the constraints on chord error, acceleration and jerk, and part (c) shows a velocity curve which respects the velocity limit curve.

### 3.1. Generation of velocity limit curve based on UALII

The maximum velocity for small linear segments occurs at the middle of a transition curve, it is therefore possible to use a two-way scanning method to obtain a velocity limit curve \( \left\lbrack  {3,4}\right\rbrack \) . However,for parametric curves, it is not so intuitive to obtain the characteristic points for the maximum velocity. The velocity limit points can only be obtained through the analysis which studies the geometrical characteristics, dynamics of machine tool axes, speed profile and contouring errors specified by users. With the interpolation resolution of 1 BLU, the next task is to use the interpolation results to generate a velocity limit curve.

Chen et al. [18] scanned the UALII interpolation results of a parametric curve to obtain a velocity limit curve. This paper extends this scanning method in two aspects: one is that jerks of individual axes are used to generate a velocity limit curve, which will be used to generate an \( S \) -shaped velocity profile. The other is that the scanning method is extended from three-dimensional trajectories to six dimensional trajectories. The key points of generating a velocity limit curve based on accelerations and chord errors can be found in [18].

<!-- Meanless: 302-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

The maximum chord error between two interpolation points \( C\left( {u}_{{k}_{1}}\right) \) and \( C\left( {u}_{{k}_{2}}\right) \) is

\[{\varepsilon }^{\left( c\right) }\left( {{k}_{1},{k}_{2}}\right)  = \operatorname{maxd}\left( {k,{k}_{1},{k}_{2}}\right) ,k \in  \left( {{k}_{1},{k}_{2}}\right)  \tag{12}\]

where the superscript(c)of \( \varepsilon \) denotes chord error. Suppose that \( C\left( {u}_{k}\right) \) is an interpolation point between \( C\left( {u}_{{k}_{1}}\right) \) and \( C\left( {u}_{{k}_{2}}\right) \) . The distance from \( C\left( {u}_{k}\right) \) to the line between \( C\left( {u}_{{k}_{1}}\right) \) and \( C\left( {u}_{{k}_{2}}\right) \) can be calculated by

\[d\left( {k,{k}_{1},{k}_{2}}\right)  = \frac{\begin{Vmatrix}\left( C\left( {u}_{k}\right)  - C\left( {u}_{{k}_{1}}\right) \right)  \times  \left( C\left( {u}_{k}\right)  - C\left( {u}_{{k}_{2}}\right) \right) \end{Vmatrix}}{\begin{Vmatrix}\left( C\left( {u}_{{k}_{1}}\right)  - C\left( {u}_{{k}_{2}}\right) \right. \end{Vmatrix}} \tag{13}\]

Therefore, to accommodate the constraints on chord error and axial acceleration, the maximum velocity must satisfy the conditions specified as

\[\left\{  \begin{array}{l} {v}^{\left( c,a\right) }\left( {s}_{{k}_{i}}\right)  = \Delta {s}_{{k}_{i}}^{\left( c,a\right) }/T \\  \Delta {s}_{{k}_{i}}^{\left( c,a\right) } = \max \left\{  \begin{array}{l} {c}_{j}\left( {{c}_{j}\left( {u}_{{k}_{i + 1}}\right)  - 2{c}_{j}\left( {u}_{{k}_{i}}\right)  + {c}_{j}\left( {u}_{{k}_{i - 1}}\right) }\right) /{T}^{2} \leq  {a}_{j,{max}}^{\left( a\right) },j = 1,\cdots ,{M}_{j} \\  {\varepsilon }^{c}\left( {{s}_{{k}_{i}},{s}_{{k}_{i}} + {\Delta s}}\right)  \leq  {\varepsilon }_{max}^{\left( c\right) },{\varepsilon }^{\left( c\right) }\left( {{s}_{{k}_{i}} - {\Delta s},{s}_{{k}_{i}}}\right)  \leq  {\varepsilon }_{max}^{\left( c\right) } \end{array}\right\}  \\  {\Delta s} \in  N,0 \leq  {\Delta s} \leq  {\Delta }_{{s}_{i}}^{\left( {max}\right) } = \min \left\{  {{v}_{c}T,{v}_{m}T,{s}_{{k}_{i}},{M}_{k} - {s}_{{k}_{i}}}\right\}   \end{array}\right. \]

(14)

where the superscript(a)and(c)denote acceleration and chord error, respectively, \( T \) is the required time for traveling an arc length of \( {\Delta s} \) , \( {c}_{j}\left( {u}_{{k}_{i}}\right) \) is the \( j \) th coordinate component of \( C\left( {u}_{{k}_{i}}\right) ,{a}_{j,\max }^{\left( a\right) } \) is the constraint on acceleration of the \( j \) th axis, \( {M}_{j} \) is the number of axes involved, \( {\varepsilon }_{\max }^{\left( c\right) } \) is the constraint on chord error, \( {s}_{{k}_{i}} \) is the arc length that has been scanned, \( {M}_{k} \) is the total arc length in terms of BLU of the \( k \) th segment, \( {v}_{c} \) is the commanded feedrate, \( {v}_{m} \) is the maximum allowable feedrate of the machine.

Taking the advantage of UALII with a resolution of 1 BLU, the scanning method uses the geometrical characteristics around an interpolation point to determine the velocity limit curve.

### 3.2. Generation of a velocity limit curve based on axial jerks

Soft acceleration/deceleration techniques can not only reduce vibrations due to sudden changes in acceleration during a movement, but also reduce tracking errors, thus improving the tracking performance in servo control of EDM. The most widely-used soft acceleration/deceleration technique is an \( S \) -shaped acceleration/deceleration velocity profile. The use of an \( S \) -shaped acceleration must consider the constraint on axial jerk. Furthermore, to improve the motion performance, the constraints on both acceleration and jerk must be considered simultaneously. Otherwise, overshooting may occur due to sudden changes in axial acceleration, which adversely affects the machining accuracy.

Before jerks are considered in the generation of a velocity limit curve, the traditional generation method is discussed first.

(15) The curvature and curvature radius can be calculated as

\[\left\{  \begin{array}{l} \kappa \left( {u}_{k}\right)  = \frac{\begin{Vmatrix}{C}^{\prime }\left( {u}_{k}\right)  \times  {C}^{\prime \prime }\left( {u}_{k}\right) \end{Vmatrix}}{{\begin{Vmatrix}{C}^{\prime }\left( {u}_{k}\right) \end{Vmatrix}}^{3}} \\  \rho \left( {u}_{k}\right)  = \frac{1}{\kappa \left( {u}_{k}\right) } \end{array}\right.  \tag{15}\]

where \( \parallel  \cdot  \parallel \) is the norm in the Euclidean space, \( \kappa \left( {u}_{k}\right) \) and \( \rho \left( {u}_{k}\right) \) are the curvature and the curvature radius at \( {u}_{k} \) ,respectively,and \( {C}^{\prime }\left( {u}_{k}\right) \) and \( {C}^{\prime \prime }\left( {u}_{k}\right) \) are the first and second order derivatives at \( {u}_{k} \) , respectively.

(16) The maximum velocity within the current interpolation period can be calculated as

\[v\left( {u}_{k}\right)  = \sqrt[3]{\frac{{J}_{\max }}{{\kappa }^{2}\left( u\right) }} \tag{16}\]

With \( v\left( {u}_{k}\right) \) ,the curvature \( \kappa \left( {u}_{k}\right) \) must be checked for the following condition

\[\kappa \left( u\right)  > \min \left\{  {{\kappa }_{\mathrm{{cbc}}},\frac{{A}_{\max }}{{F}^{2}},\sqrt{\frac{{J}_{\max }}{{F}^{3}}}}\right\}   \tag{17}\]

where \( {\kappa }_{\mathrm{{cbc}}} \) is the curvature constant [29], \( {A}_{\max } \) and \( {J}_{\max } \) are the maximum allowable acceleration and the maximum allowable jerk for an axis, respectively.

(17) Based on the current parameter \( {u}_{k} \) ,the parameter for the next point \( {u}_{k + 1} \) can be obtained by the second order Taylor series expansion

\[{\Delta s} = v\left( {u}_{k}\right) {T}_{s} + \frac{1}{2}{T}_{s}^{2}A\left( {u}_{k}\right)  \tag{18}\]

where \( {T}_{s} \) is the interpolation period,and \( A\left( {u}_{k}\right) \) is the acceleration in the current interpolation period.

It can be noticed that when calculating the jerk limit curve, only the geometrical information at the current interpolation point is used, without considering the geometrical characteristics near the point. When the velocity is high, interpolation points are sparse, which makes the velocity limit curve inaccurate. In order to apply the \( S \) -shaped velocity planning in multi-axis EDM, it is necessary to generate the velocity limit curve based on the jerk constraint.

Jerk can be approximated by a difference between two accelerations at two consecutive points. To calculate the average acceleration at a point, three commanded positions are needed. Suppose that the current arc length is \( {s}_{{k}_{i}} \) ,the corresponding curve parameter is \( {u}_{{k}_{i}} \) ,and the commanded position is \( C\left( {u}_{k}\right) \) ,the acceleration \( {a}_{{k}_{i}} \) at \( C\left( {u}_{k}\right) \) is obtained as

\[{a}_{{k}_{i}} = \frac{1}{T}\left( {\frac{C\left( {u}_{{k}_{i + 1}}\right)  - C\left( {u}_{{k}_{i}}\right) }{T} - \frac{C\left( {u}_{{k}_{i}}\right)  - C\left( {u}_{{k}_{i - 1}}\right) }{T}}\right)  \tag{19}\]

\[ = \frac{C\left( {u}_{{k}_{i + 1}}\right)  - {2C}\left( {u}_{{k}_{i}}\right)  + C\left( {u}_{{k}_{i - 1}}\right) }{{T}^{2}}\]

where \( C\left( {u}_{{k}_{i - 1}}\right) \) and \( C\left( {u}_{{k}_{i + 1}}\right) \) are the commanded positions corresponding to the curve parameter \( {u}_{{k}_{i - 1}} \) and \( {u}_{{k}_{i + 1}} \) ,respectively. The arc length corresponding to \( {u}_{{k}_{i + 1}} \) is \( {s}_{{k}_{i + 1}} = {s}_{{k}_{i}} + {\Delta s} \) ,while the arc length corresponding to \( {u}_{{k}_{i - 1}} \) is \( {s}_{{k}_{i - 1}} = {s}_{{k}_{i}} - {\Delta s},T \) is the time required for the arc length of \( {\Delta s} \) . The jerk can now be calculated by a finite difference as

\[{j}_{{k}_{i}} = \frac{1}{T}\left( {{a}_{{k}_{i}} - {a}_{{k}_{i - 1}}}\right)  \tag{20}\]

\[ = \frac{C\left( {u}_{{k}_{i + 1}}\right)  - {3C}\left( {u}_{{k}_{i}}\right)  + {3C}\left( {u}_{{k}_{i - 1}}\right)  - C\left( {u}_{{k}_{i - 2}}\right) }{{T}^{3}}\]

Based on these,considering the commanded velocity \( {v}_{c} \) and the maximum allowable velocity \( {v}_{m} \) ,the velocity constraint \( {v}_{\left( {s}_{{k}_{i}}\right) }^{\left( j\right) } \) at commanded position \( C\left( {u}_{{k}_{i}}\right) \) corresponding to the arc length \( {s}_{{k}_{i}} \) must satisfy the following conditions

\[\left\{  \begin{matrix} {v}^{\left( \mathrm{{je}}\right) }\left( {s}_{{k}_{i}}\right)  = \Delta {s}_{{k}_{i}}^{\left( \mathrm{{je}}\right) }/T \\  \Delta {s}_{{k}_{i}}^{\left( \mathrm{{je}}\right) } = \max \left\{  {{\Delta s}\left| {\;\begin{array}{l} \left( {{c}_{j}\left( {u}_{{k}_{i + 1}}\right)  - 3{c}_{j}\left( {u}_{{k}_{i}}\right)  + 3{c}_{j}\left( {u}_{{k}_{i - 1}}\right) }\right)  - {c}_{j}\left( {u}_{{k}_{i - 2}}\right) /{T}^{3} \leq  {J}_{j,{max}}^{\left( \mathrm{{je}}\right) } \\  j = 1,\cdots ,{M}_{j},{\Delta s} \in  N,0 \leq  {\Delta s} \leq  \Delta {s}_{{k}_{i}}^{\max } \end{array}}\right. }\right\}  /{T}^{3} \leq  {J}_{j,{max}}^{\left( \mathrm{{je}}\right) } \end{matrix}\right\}  \]

(21)

<!-- Meanless: 303-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

where \( {J}_{j,\max }^{\left( \mathrm{{je}}\right) } \) is the maximum allowable jerk for the \( j \) th axis,the superscript (je) stands for jerk, \( {c}_{j}\left( {u}_{{k}_{i}}\right) \) is the \( j \) th axial coordinate of the point \( C\left( {u}_{{k}_{i}}\right) \) ,the arc length between two commanded positions is \( {\Delta s} \) ,and \( N \) is the nonnegative integer set. The procedure for generating the velocity limit curve based on the constraint on jerk can be listed as follows

<!-- Media -->

<!-- figureText: \( {\mathbf{C}}_{I}^{l}\left( {u}_{{k}_{i}}\right) \) \( {\mathbf{C}}_{I + 1}^{l}\left( {u}_{{k}_{i}}\right) \) \( {r}_{I + 1}^{i} \) θ -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_5.jpg?x=402&y=151&w=941&h=565&r=0"/>

Fig. 5. Connection of two NURBS curves.

<!-- Media -->

1. Let \( {\Delta s} = 1 \) ,calculate the maximum arc length increment under the conditions of the current arc length \( {s}_{{k}_{i}} \) ,commanded velocity \( {v}_{c} \) , allowable velocity \( {v}_{m} \) ,and the overall interpolated arc length \( \Delta {s}_{{k}_{i}}^{\left( \max \right) } = \min \left\{  {{v}_{c}T,{v}_{m}T,{s}_{{k}_{i}},{M}_{k} - {s}_{{k}_{i}}}\right\}  . \)

2. if \( {\Delta s} > \Delta {s}_{{k}_{i}}^{\left( \max \right) } \) ,go to Step (4),otherwise compute the interpolation point \( C\left( {u}_{{k}_{i + 1}}\right) \) at \( {s}_{{k}_{i}} + {\Delta s},C\left( {u}_{{k}_{i}}\right) \) at \( {s}_{{k}_{i}},C\left( {u}_{{k}_{i - 1}}\right) \) at \( {s}_{{k}_{i}} - {\Delta s} \) ,and \( C\left( {u}_{{k}_{i - 2}}\right) \) at \( {s}_{{k}_{i}} - {2\Delta s} \) . Then use Eq. (21) to check whether the conditions are met. If any of the conditions is violated, go to Step (4).

3. Let \( {\Delta s} = {\Delta s} + 1 \) ,go to Step 2.

4. Record the maximum velocity as \( {v}^{\left( \mathrm{{je}}\right) }\left( {s}_{{k}_{i}}\right)  = \left( {{\Delta s} - 1}\right) /T \) . Let \( {k}_{i} = {k}_{i} + \) 1. If \( {k}_{i} \leq  {M}_{k} \) ,the re-calculate \( \Delta {s}_{{k}_{i}}^{\left( \max \right) } = \min \left\{  {{v}_{c}T,{v}_{m}T,{s}_{{k}_{i}},{M}_{k} - {s}_{{k}_{i}}}\right\} \) , then go to Step (2). Otherwise, it indicates that the last point has been scanned for this segment of the parametric curve based on the constraint on jerk.

From the description of the scanning algorithm, it can be seen that the scanning method based on the constraint on jerk can be incorporated into the scanning methods on the constraints on chord error and acceleration.

## 4. Velocity limit curve for multi-axis EDM

The scanning method for UALII can obtain the velocity limit curve for one parametric curve under all types of constraints. A multi-axis trajectory is represented by a double-NURBS curve. The velocity is a tangential velocity which is a compound velocity involving all axes. Therefore, it is necessary to combine all axial velocities with the same curve parameter \( {u}_{k} \) ,thus the scanning method can then be applied to double-NURBS curves.

Suppose that the arc lengths for the \( I \) th segment of the position curve, and the angle curve are \( {L}_{I}^{l} \) and \( {L}_{I}^{r} \) ,respectively,the composite arc length of this segment is

\[{L}_{I} = \sqrt{{\left( {L}_{I}^{l}\right) }^{2} + {\left( {L}_{I}^{r}\right) }^{2}} \tag{22}\]

For the primary curve of a double-NURBS curve, the component of the maximum velocity at \( {C}_{I}^{l}\left( {u}_{{k}_{i}}\right) \) is \( {v}_{I}^{l}\left( {s}_{{k}_{i}}^{l}\right) \) ,then the arc length for the following curve (the angle curve) is

<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

\[{s}_{{k}_{i}}^{r} = \frac{{L}_{I}^{r}}{{L}_{I}^{l}}{s}_{{k}_{i}}^{l} \tag{23}\]

<!-- Media -->

Table 1

Parameters for velocity limit curve scanning.

<table><tr><td>\( {\Delta s} \)</td><td>1 BLU</td></tr><tr><td>\( {\varepsilon }_{\max }^{\left( c\right) } \)</td><td>2 BLU</td></tr><tr><td>\( \min \left\{  {{v}_{c},{v}_{m}}\right\} \)</td><td>\( 5 \times  {10}^{4}\mathrm{\;{BLU}}/\mathrm{s} \)</td></tr><tr><td>\( {a}_{j,\max }^{\left( a\right) } \)</td><td>\( 5 \times  {10}^{5}\mathrm{{BLU}}/{s}^{2} \)</td></tr><tr><td>\( {J}_{j,\max }^{\left( je\right) } \)</td><td>\( 8 \times  {10}^{7}\mathrm{{BLU}}/{s}^{3} \)</td></tr><tr><td>\( {T}_{s} \)</td><td>2 ms</td></tr></table>

<!-- figureText: \( {V}_{n} \) \( S \) 0 \( {S}_{1} \) \( {s}_{2} \) -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_5.jpg?x=403&y=1731&w=937&h=415&r=0"/>

Fig. 6. An example of the motion trajectory scanning method.

<!-- Meanless: 304-->


<!-- figureText: 55 VLC of position curve 2.5 3 Arc length parameter (BLU) x \( {10}^{4} \) VLC of rotary curve 10 12 14 16 18 Arc length parameter (BLU) x \( {10}^{4} \) 50 45 40 Velocty (BLU/ms) 35 30 25 20 15 10 0 0.5 1 Velocty (BLU/ms) 35 15 0 2 6 8 -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_6.jpg?x=324&y=150&w=1095&h=1182&r=0"/>

Fig. 7. Velocity limit curves by UALII: (a) velocity limit curve from position curve; (b) velocity limit curve from angle curve.

<!-- Media -->

where \( {s}_{{k}_{i}}^{l} \) and \( {s}_{{k}_{i}}^{r} \) are the arc lengths at \( u = {u}_{{k}_{i}} \) of the position and angle curves,respectively. The maximum velocity of the angle curve is \( {v}_{I}^{r}\left( {s}_{{k}_{i}}^{r}\right) \) . According to Eq. (22), the composite maximum velocity is

\[{v}_{I}\left( {s}_{{k}_{i}}\right)  = \min \left\{  {\frac{{L}_{I}}{{L}_{I}^{l}}{v}_{I}^{l}\left( {s}_{{k}_{i}}^{l}\right) ,\frac{{L}_{I}}{{L}_{I}^{r}}{v}_{I}^{r}\left( {s}_{{k}_{i}}^{r}\right) ,{v}_{c},{v}_{m}}\right\}   \tag{24}\]

In six-axis EDM machining, to generate the velocity limit curve for a trajectory represented by a double-NURBS curve, the first step is to use the scanning algorithm to obtain the velocity limit curves for both the position curve and the angle curve. The second step is to use Eq. (24) to obtain a composite velocity limit curve.

The above discussion only focuses on the \( I \) th segment. In actual machining, one single double-NURBS curve may not be able to represent an actual machining trajectory, which is usually be expressed by a series of double-NURBS curves. However, at junctions between two segments, only \( {C}^{0} \) continuity can be ensured,and it is not possible to obtain the velocity limit curve through the scanning method. It is therefore necessary to consider a way of obtaining a velocity limit curve at junctions. As shown in Fig. 5,the connecting curve between segments \( {C}_{I}^{l}\left( u\right) \) and \( {C}_{I + 1}^{l}\left( u\right) \) are the \( I \) th and \( \left( {I + 1}\right) \) th double-NURBS curve segment, respectively, \( {r}_{I}^{l} \) and \( {r}_{I + 1}^{l} \) are the tangential vectors at the junction point

## \( {Q}_{I}^{l},\theta \) is the angle between the two tangential vectors.

The velocity limit curve at \( {Q}_{I}^{l} \) can be treated in the same way for junctions between line segments as discussed in [3]. The maximum velocity at \( {Q}_{I}^{l} \) can be written as

\[{v}_{I}^{l}\left( {Q}_{I}^{l}\right)  = \min \left\{  {\frac{{a}_{\max }{T}_{s}}{2\sin \left( {\theta /2}\right) },{v}_{c},{v}_{m}}\right\}   \tag{25}\]

Similarly, the velocity limit curve for the angle curve at junctions can be obtained. Combining Eqs. (24) and (25), it is possible to generate the velocity limit curve \( v\left( {s}_{k}\right) \) through the scanning algorithm for every interpolation point,then an \( S \) -shaped velocity profile can then be generated with the method introduced in [3].

It needs to be noted that, under the coder-player architecture, the calculation for interpolation points and the scanning procedure for obtaining a velocity limit curve can be carried out offline in the coder, while the planning for acceleration/deceleration is carried out online in the player.

## 5. Scanning segments of a trajectory based on a coder

Within a coder, the purpose of scanning a trajectory is to divide the obtained velocity limit curve into segments. For a continuous trajectory, the velocity always starts from zero at the starting point, and decelerates to zero at the ending point. Between the starting point and the ending point, the trajectory will experience a number of accelerations and decelerations. As shown in Fig. 6, the period during which the velocity accelerates to a maximum and decelerates to a velocity below the commanded velocity is called a velocity segment. Referring to the dashed rectangle in Fig. 6, the velocity between the arc length parameter \( {s}_{1} \) and \( {s}_{2} \) is a velocity segment. In the velocity segment,the staring velocity at \( {s}_{1} \) is \( {v}_{1} \) and the ending velocity at \( {s}_{2} \) is \( {v}_{2} \) ,and the maximum velocity is the commanded velocity \( {v}_{m} \) . The procedure for scanning

<!-- Meanless: 305-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

<!-- Media -->

<!-- figureText: 55 VLC of feed path 12 16 18 Arc length parameter (BLU) \( \times  {10}^{4} \) VLC of feed path 1.1 1.15 1.2 1.25 1.3 1.35 Arc length parameter (BLU) x 105 50 40 Velocty (BLU/ms) 35 30 25 20 15 2 6 55 50 45 40 Velocty (BLU/ms) 35 30 25 20 15 10 5 0 0.85 0.9 0.95 1.05 -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_7.jpg?x=327&y=147&w=1093&h=1225&r=0"/>

Fig. 8. Velocity limit curves for multi-axis trajectory: (a) velocity limit curve for compound velocity; (b) amplified velocity limit curve for the dashed part of (a).

<!-- figureText: 50 3000 3500 4000 4500 5000 Time (ms) 45 Velocty (BLU/ms) 30 25 20 15 10 5 0 0 500 1000 1500 2000 2500 -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_7.jpg?x=404&y=1472&w=942&h=489&r=0"/>

Fig. 9. The scheduled feedrate profile of multi-axis trajectory.

<!-- Meanless: 306-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

Table 2

EDM parameters for shrouded blisk.

<table><tr><td>Pulse on</td><td>\( {80\mu }\mathrm{m} \)</td></tr><tr><td>Pulse off</td><td>\( {8\mu }\mathrm{m} \)</td></tr><tr><td>Open loop voltage</td><td>120 V</td></tr><tr><td>Peak current</td><td>36 A</td></tr><tr><td>Jumping interval</td><td>5s</td></tr><tr><td>Jumping height</td><td>2 mm</td></tr><tr><td>Polarity of electrode</td><td>Positive</td></tr></table>

<!-- Media -->

segments of a trajectory is stated as

1. Let the scanning arc length \( {s}_{k} = 0 \) ,set the scanning velocity at this arc length \( {v}_{s}\left( {s}_{k}\right)  = 0 \)

2. \( {s}_{k} = {s}_{k} + 1 \) ,fetch the maximum velocity \( v\left( {s}_{k}\right) \) from the composite velocity at the interpolation point \( C\left( {u}_{k}\right) \) and the maximum velocity \( v\left( {s}_{{k}_{i + 1}}\right) \) There are four cases that need to be discussed.

- if \( v\left( {s}_{k}\right)  > v\left( {s}_{k - 1}\right) \) and \( v\left( {s}_{k}\right)  < v\left( {s}_{k + 1}\right) \) ,the current point is still at the acceleration stage for the current velocity segment.

- if \( v\left( {s}_{k}\right)  > v\left( {s}_{k - 1}\right) \) and \( v\left( {s}_{k}\right)  > v\left( {s}_{k + 1}\right) \) ,then current velocity \( v\left( {s}_{k}\right) \) is the maximum for the current velocity segment.

- if \( v\left( {s}_{k}\right)  < v\left( {s}_{k - 1}\right) \) and \( v\left( {s}_{k}\right)  < v\left( {s}_{k + 1}\right) \) ,then the velocity for the current point is the minimum for the current velocity segment. Record \( {v}_{\min } \) at the current arc length \( {s}_{k} \) . The current point is the ending point for the current velocity segment and the starting point for the next velocity segment.

- if \( v\left( {s}_{k}\right)  < v\left( {s}_{k - 1}\right) \) and \( v\left( {s}_{k}\right)  > v\left( {s}_{k + 1}\right) \) ,then the current point is still at the deceleration stage.

3. if \( {s}_{k} < {L}_{\text{total }} \) ,where \( {L}_{\text{total }} \) is the overall arc length,then go to step (2). Otherwise, the scanning has finished.

Through the scanning of segments, the velocity segment as a function of \( {s}_{k} \) can be obtained. Thus the bitstream contains movement information at interpolation points, which can be used in velocity planning in a player.

Under the coder-player architecture, the coder converts the geometrical and movement information into a bitstream, which is then sent to a player. After receiving the bitstream, the player firstly decodes the bitstream according to the protocol, and then controls the electrode movements based on the discharging gap status. There are three types of movements in EDM, i.e., servo feeding movement, jumping movement, and pause. In servo feeding movements, the feedrate is adjusted based on a gap status indicator, such as average gap voltage, and normal discharge ratio. Servo feeding movements include both forward and backward movements, with the magnitude and direction determined by a servo controller. Therefore, no feedrate planning is needed. By contrast, during jumping movements and pauses, no discharge occurs. In this paper, jumping is used as an example for velocity planning in the player.

Jumping is a periodic movement in which the electrode moves backward along the original feeding trajectory for a certain distance, and then moves forward to its starting point. The purpose of jumping is to create a pumping effect by which the debris can be expelled out of the discharging gap so that the clean dielectric can enter into the discharging gap. As the jumping velocity is fast, velocity planning is needed. Suppose the arc length is \( {s}_{{k}_{0}} \) at the starting point of a jumping, and the jumping height is \( H \) ,the arc length at the ending point of the jumping is

\[{s}_{{k}_{i}} = {s}_{{k}_{0}} - H \tag{26}\]

where the units for \( {s}_{{k}_{i}},{s}_{{k}_{0}} \) ,and \( H \) are BLU.

The velocities at the starting and ending points of a jumping are set to zero. In a jumping, the bitstream already contains the connection points for accelerations and decelerations, and the velocity limit. The task left is to first extract the velocity limit and the corresponding curve parameter \( {u}_{k} \) ,and then to generate an \( S \) -shaped velocity limit curve according to the \( S \) -shape acceleration/deceleration algorithm. While the approximation for a parametric curve and the scanning module for the velocity limit curve are implemented in the coder, the task of the player is to extract the arc increment from the movement bitstream which is calculated by the velocity planning module, and then to decompose the movement into individual axial increments which are sent to motor drives.

<!-- Media -->

Table 3

The average machining time of channels with different methods

<table><tr><td>Planning method</td><td>Traditional</td><td>Trajectory smoothing</td><td>Double- NURBS</td></tr><tr><td>Average machining time</td><td>70 min 37 s</td><td>56 min 43 s</td><td>49 min 52 s</td></tr></table>

<!-- figureText: 10 mm -->

<img src="https://cdn.noedgeai.com/bo_d2slb7ref24c73b2kg40_8.jpg?x=408&y=1410&w=929&h=734&r=0"/>

Fig. 10. The machined channels by the proposed velocity planning.

<!-- Media -->

<!-- Meanless: 307-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

## 6. Simulation and experimental validation

With the parameters for velocity limit curve scanning as listed in Table 1, the proposed UALII-based scanning method is now applied to a double-NURBS curve to generate the velocity limit curve. The double-NURBS curve is used for machining a shrouded blisk by a six-axis EDM machine. In the coder, UALII is used to generate the interpolation points with a resolution of 1 BLU. Considering the constraints on chord error, acceleration, and jerk of all axes, the UALII scanning method is then utilized to obtain the velocity limit curve. In this experiment,the scanning increment \( {\Delta s} = 1\mathrm{{BLU}} \) ,the minimum of the machine feedrate and the commanded feedrate \( \min \left\{  {{v}_{c},{v}_{m}}\right\}   = 5 \times  {10}^{4} \) \( \mathrm{{BLU}}/\mathrm{s} \) ,the maximum chord error is \( 2\mathrm{{BLU}} \) ,the maximum acceleration for all axes is \( {a}_{j,\max }^{\left( c\right) } = 5 \times  {10}^{5}\mathrm{{BLU}}/\mathrm{s} \) ,and the maximum jerk for all axes is \( {J}_{j,\max }^{\left( \mathrm{{je}}\right) } = 8 \times  {10}^{7}\mathrm{{BLU}}/{s}^{3} \) ,and the interpolation period \( {T}_{s}2\mathrm{\;{ms}} \) .

By using the UALII scanning method, the velocity limit curves for the position curve and the angle curve are shown in Fig. 7a and 7 b, respectively. The horizontal axis represents the arc length parameter, while the vertical axis represents the value of the velocity limit. The total number of steps for the position curve is 31,602, meaning that the arc length is 31,602 BLUs. The total number of steps for the angle curve is 189,879, meaning that the arc length is 189,879 BLUs. Fig. 8(a) shows that the velocity limit curve for the double-NURBS curve, the composite arc length is 192,491 BLUs, which is an orthogonal combination of the position curve and the angle curve. The composite arc length is 192,491 BLUs, which means that the number of interpolation steps is 192,491. To see more clearly the velocity limit curve enclosed by the rectangle as in Fig. 8(a), Fig. 8(b) shows the velocity limit curve with the arc length parameter in the range of \( \left\lbrack  {{85},{000},{136},{500}}\right\rbrack \) .

Fig. 9 shows the planned velocity profile for the multi-axis trajectory after the multi-axis velocity limit curve has been obtained. It can be seen that the time required for the interpolation is \( {5.38}\mathrm{\;s} \) . It should be noted that the feedrate in EDM is determined online by the servo controller. However, as the jumping velocity is high, velocity planning is necessary. Velocity planning is also needed when the multi-axis EDM machining is finished, as the electrode needs to be retracted from the channel with a high velocity.

## 7. Multi-axis EDM for a shrouded blisk

A shrouded blisk was machined on the 6-axis EDM machine with the EDM parameters as listed in Table 2. The purpose of this machining test is to experimentally testify the representation of a multi-axis trajectory with a double-NURBS curve, and also the UALII-scanning method for double-NURBS curves. The CNC system of the EDM machine was implemented with a coder-player architecture.

Three channels were machined from the \( Y \) - direction to the \( Y + \) direction. The machined surface and the channels are shown in Fig. 10. The machining time using the double-NURBS curve is shown in Table 3. The machining time by the double-NURBS curve method is \( {49}\mathrm{\;{min}}{52}\mathrm{\;s} \) , which has been decreased by \( {29.38}\% \) from \( {70}\mathrm{\;{min}}{37}\mathrm{\;s} \) with the conventional method and by \( {12.08}\% \) from \( {56}\mathrm{\;{min}}{43}\mathrm{\;s} \) with the multiaxis corner rounding solution (MCRS) [3].

The reduction in machining time can be explained as follows. As compared with the generalized segments or the smoothing trajectory, the double-NURBS parametric curve has the \( {C}^{2} \) continuity,reducing the velocity losses at junctions between line segments. It is also true that there is no need for smoothing at corners, thus achieving larger accelerations at corners. The experiments conducted show that a trajectory for multi-axis EDM can be represented by a double-NURBS curve in the machine frame. The velocity planning based on the coder-player architecture can improve the machining efficiency.

## 8. Conclusion

In order to reduce the real-time computational load for velocity planning, this paper proposes a velocity planning for multi-axis EDM based on a coder-player architecture. Under this architecture, a multi-axis feeding trajectory is represented by a double-NURBS curve which is then interpolated by the unit arc length increment interpolation (UALII) with a resolution of 1 BLU. A scanning method is used to generate a velocity limit curve for double-NURBS curves by considering the constraints on acceleration and jerk. With \( {C}^{2} \) continuities for the trajectories represented double-NURBS curves, velocity losses at conjunctions between line segments can be greatly reduced. As no smoothing at junctions between line segments is needed, a higher jumping velocity can be achieved, thus improving the machining efficiency.

A simulation is conducted to generate a velocity limit curve for a double-NURBS curve. The velocity planning method is analyzed on a coder-player architecture. Machining experiments showed that with the use of proposed velocity planning, the machining time for a single channel of a shrouded blisk is reduced by 29.38%. As compared with the corner smoothing method proposed in [4], the average machining time is reduced by 12.08%.

## Declaration of Competing Interest

The authors report no declarations of interest.

## Acknowledgement

This research is financially supported by National Natural Science Foundation of China (No. 52075333), National Major Science and Technology Projects of China(No. 2018ZX04005001), Shenzhen Basic Research Program (Grant No. JCYJ20170811160440239), and Postdoctoral Science Foundation of China (No. 2017M621460). References

[1] Klocke F, Klink A, Veselovac D, Aspinwall DK, Soo SL, Schmidt M, et al. Turbomachinery component manufacture by application of electrochemical, electro-physical and photonic processes. CIRP Ann Manuf Technol 2014;63(2): 703-26.

[2] Huang H, Chi G, Wang Z. Development and application of software for open and soft multi-axis EDM CNC systems. Int J Adv Manuf Technol 2016;86(9-12): 2689-700.

[3] Liu HD, Xi XC, Liang W, Chen M, Chen H, Zhao WS. A look-ahead transition algorithm for jump motions with short line segments in EDM. Int J Adv Manuf Technol 2018;95(1-4):1409-19.

[4] Liu HD, Xi XC, Chen M, Zhao WS. A look-ahead transition algorithm and jump motion planning in multi-axis EDM for shrouded blisks. Int J Adv Manuf Technol 2018:1-12.

[5] Zhang Y, Zhao M, Ye P, Jiang J, Zhang H. Optimal curvature-smooth transition and toolpath. Int J Adv Manuf Technol 2018;99(1-4):169-79.

[6] Praniewicz M, Kurfess TR, Saldana C. Error qualification for multi-axis BC-type machine tools. J Manuf Syst 2019;52:211-6.

[7] Cai Y, Zhang F, Xi X. Cutter orientation planning in NC machining for surface similar to revolution body with considering kinematic characteristics. Int J Adv Manuf Technol 2019;100(1-4):503-13.

[8] Fang Y, Hu J, Liu W, Shao Q, Qi J, Peng Y. Smooth and time-optimal S-curve trajectory planning for automated robots and machines. Mech Mach Theory 2019; 137:127-53.

[9] Weng WH, Kuo CFJ. Jerk decision for free-form surface effects in multi-axis synchronization manufacturing. Int J Adv Manuf Technol 2019;105(1-4):799-812.

[10] Hashemian A, Bo P, Barton F.M. Reparameterization of ruled surfaces: toward generating smooth jerk-minimized toolpaths for multi-axis flank CNC milling. CAD Comput Aided Des 2020;127:102868.

[11] Chu C-H, Chen H-Y, Chang C-H. Continuity-preserving tool path generation for minimizing machining errors in five-axis CNC flank milling of ruled surfaces. J Manuf Syst 2020;55:171-8.

[12] Li Z, Tang K. Partition-based five-axis tool path generation for freeform surface machining using a non-spherical tool. J Manuf Syst 2021;58:248-62.

<!-- Meanless: 308-->




<!-- Meanless: X.-C. Xi et al. Journal of Manufacturing Systems 59 (2021) 299-309-->

[13] Giberti H, Sbaglia L, Urgo M. A path planning algorithm for industrial processes under velocity constraints with an application to additive manufacturing. J Manuf Syst 2017;43:160-7.

[14] Qiao Z, Wang T, Wang Y, Hu M, Liu Q. Bézier polygons for the linearization of dual NURBS curve in five-axis sculptured surface machining. Int J Mach Tools Manuf 2012;53(1):107-17.

[15] Liu X, Kang X, Zhao W, Liang W. Electrode feeding path searching for 5-axis EDM of integral shrouded blisks. Proc CIRP 2013;6:107-11.

[16] Liu X, Kang X, Xi X, Liang W, Zhao W. Electrode feed path planning for multi-axis EDM of integral shrouded impeller. Int J Adv Manuf Technol 2013;68(5-8): 1697-706.

[17] Xi XC, Chen H, Liu HD, Chen M, Zhao WS. Extended unit arc length increment interpolation for generalized NURBS curves in multi-axis EDM. Precis Eng 2019;59: 81-9.

[18] Chen M, Xi XC, Zhao WS, Chen H, Liu HD. A universal velocity limit curve generator considering abnormal tool path geometry for CNC machine tools. J Manuf Syst 2017;44:295-301.

[19] Zhao W, Chen M, Chen H. A novel trajectory interpolation algorithm for WEDM - unit generalized arc length increment method. Proc CIRP 2013;6:255-60.

[20] Zhao W, Zheng J, Xi X, Chen M, Chen H, Xia W, et al. A new model of WEDM-CNC system with digitizer/player architecture. Proc CIRP 2016;42:210-4.

[21] Zhao H, Lu Y, Zhu L, Ding H. Look-ahead interpolation of short line segments using B-spline curve fitting of dominant points. Proc Inst Mech Eng B 2015;229(7): 1131-43.

[22] Chen M, Zhao WS, Xi XC. Augmented Taylor's expansion method for B-spline curve interpolation for CNC machine tools. Int J Mach Tools Manuf 2015;94:109-19.

[23] Lei WT, Wang SB. Robust real-time NURBS path interpolators. Int J Mach Tools Manuf 2009;49(7-8):625-33.

[24] Liu M, Huang Y, Yin L, Guo J, Shao X, Zhang G. Development and implementation of a NURBS interpolator with smooth feedrate scheduling for CNC machine tools. Int J Mach Tools Manuf 2014;87:1-15.

[25] Heng M, Erkorkmaz K. Design of a NURBS interpolator with minimal feed fluctuation and continuous feed modulation capability. Int J Mach Tools Manuf 2010;50(3):281-93.

[26] Cheng MY, Tsai MC, Kuo JC. Real-time NURBS command generators for CNC servo controllers. Int J Mach Tools Manuf 2002;42(7):801-13.

[27] Cheng CW, Tsai MC, Maciejowski J. Feedrate control for non-uniform rational B-spline motion command generation. Proc Inst Mech Eng B 2006;220(11):1855-61.

[28] Tsai MC, Chung CW. A real-time predictor-corrector interpolator for CNC machining. J Manuf Sci Eng Trans ASME 2003;125(3):449-60.

[29] Xu Z, Chen J, Feng Z. Performance evaluation of a real-time interpolation algorithm for NURBS curves. Int J Adv Manuf Technol 2002;20(4):270-6.

<!-- Meanless: 309-->

